(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{50:function(e,t,a){e.exports=a(81)},55:function(e,t,a){},81:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(41),o=a.n(s),i=(a(55),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function l(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}var c=a(10),u=a(23),m=function(){return r.a.createElement("header",{className:"root"},r.a.createElement("h1",null,"PWA twitter"))},h=a(18),p=a(11),d=a(3),f=a(4),b=a(6),v=a(5),g=a(7),E=a(13),w=r.a.createContext(null),O=function(e){return function(t){return r.a.createElement(w.Consumer,null,function(a){return r.a.createElement(e,Object.assign({},t,{firebase:a}))})}},j=w,y=a(26),S=a.n(y),C=(a(59),a(61),a(65),a(82),{apiKey:"AIzaSyAe7hufjDHedAdKMIeT_MhjN_Oc1X34HoA",authDomain:"superp2-8a0d2.firebaseapp.com",databaseURL:"https://superp2-8a0d2.firebaseio.com",projectId:"superp2-8a0d2",storageBucket:"superp2-8a0d2.appspot.com",messagingSenderId:"499719922525",appId:"1:499719922525:web:cf330b8bb5ce987b"}),U=function e(){var t=this;Object(d.a)(this,e),this.doCreateUserWithEmailAndPassword=function(e,a){return t.auth.createUserWithEmailAndPassword(e,a)},this.doSignInWithEmailAndPassword=function(e,a){return t.auth.signInWithEmailAndPassword(e,a)},this.doSignOut=function(){return t.auth.signOut()},this.doPasswordReset=function(e){return t.auth.sendPasswordResetEmail(e)},this.doPasswordUpdate=function(e){return t.auth.currentUser.updatePassword(e)},this.onAuthUserListener=function(e,a){return t.auth.onAuthStateChanged(function(n){n?t.user(n.uid).once("value").then(function(t){var a=t.val();n=Object(p.a)({uid:n.uid,email:n.email,emailVerified:n.emailVerified},a),e(n)}):a()})},this.user=function(e){return t.db.ref("users/".concat(e))},this.users=function(){return t.db.ref("users")},this.message=function(e){return t.db.ref("messages/".concat(e))},this.messages=function(){return t.db.ref("messages")},this.tweet=function(e){return t.db.ref("tweets/".concat(e))},this.tweets=function(){return t.db.ref("tweets")},this.chat=function(e){return t.db.ref("chats/".concat(e))},this.chats=function(){return t.db.ref("chats")},this.notification=function(e){return t.db.ref("notifications/".concat(e))},this.notifications=function(){return t.db.ref("notifications")},this.image=function(e){return t.storage.ref("images/".concat(e))},this.images=function(){return t.storage.ref("images")},S.a.initializeApp(C),this.serverValue=S.a.database.ServerValue,this.auth=S.a.auth(),this.db=S.a.database(),this.storage=S.a.storage()},T="/home",N="/account",x={username:"",name:"",email:"",passwordOne:"",passwordTwo:"",isAdmin:!1,error:null},k="le compte existe deja",F=" error",I=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).onSubmit=function(e){var t=a.state,n=t.username,r=t.name,s=t.email,o=t.passwordOne;a.props.firebase.doCreateUserWithEmailAndPassword(s,o).then(function(e){var t=e.user.uid;return a.setState({uid:t}),a.props.firebase.user(e.user.uid).set({username:n,name:r,email:s,uid:t,src:"https://firebasestorage.googleapis.com/v0/b/superp2-8a0d2.appspot.com/o/images%2Fdefault_photo%2F250px-Ouisticram-Pt.png?alt=media&token=c48c3326-e329-4faa-838c-40454802b632"})}).then(function(){var e=a.props.firebase.notifications().push().key;return a.props.firebase.user(a.state.uid).update({notifId:e}),a.props.firebase.doSendEmailVerification()}).then(function(){a.setState(Object(p.a)({},x)),a.props.history.push(N)}).catch(function(e){e.code===k&&(e.message=F),a.setState({error:e})}),e.preventDefault()},a.onChange=function(e){a.setState(Object(h.a)({},e.target.name,e.target.value))},a.onChangeCheckbox=function(e){a.setState(Object(h.a)({},e.target.name,e.target.checked))},a.state=Object(p.a)({},x),a}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.state,t=e.username,a=e.email,n=e.passwordOne,s=e.passwordTwo,o=e.error,i=e.name,l=n!==s||""===n||""===a||""===i||""===t;return r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"username"},r.a.createElement("b",null,"User Name"),r.a.createElement("input",{name:"username",value:t,onChange:this.onChange,type:"text",placeholder:"Full Name"})),r.a.createElement("label",{htmlFor:"name"},r.a.createElement("b",null,"Name"),r.a.createElement("input",{name:"name",value:i,onChange:this.onChange,type:"text",placeholder:" Name"})),r.a.createElement("label",{htmlFor:"email"},r.a.createElement("b",null,"Email Address"),r.a.createElement("input",{name:"email",value:a,onChange:this.onChange,type:"text",placeholder:"Email Address"})),r.a.createElement("label",{htmlFor:"passwordOne"},r.a.createElement("b",null,"Password"),r.a.createElement("input",{name:"passwordOne",value:n,onChange:this.onChange,type:"password",placeholder:"Password"})),r.a.createElement("label",{htmlFor:"passwordTwo"},r.a.createElement("b",null,"Confirm Password"),r.a.createElement("input",{name:"passwordTwo",value:s,onChange:this.onChange,type:"password",placeholder:"Confirm Password"})),r.a.createElement("button",{className:"registerbtn",disabled:l,type:"submit"},"Sign Up"),o&&r.a.createElement("p",null,o.message)))}}]),t}(n.Component),R=function(){return r.a.createElement("p",null,"Don't have an account? ",r.a.createElement(c.b,{to:"/signup"},"Sign Up"))},_=Object(E.a)(u.e,O)(I),A=function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"Register"),r.a.createElement(_,null))},L={email:"",error:null},P=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).onSubmit=function(e){var t=a.state.email;a.props.firebase.doPasswordReset(t).then(function(){a.setState(Object(p.a)({},L))}).catch(function(e){a.setState({error:e})}),e.preventDefault()},a.onChange=function(e){a.setState(Object(h.a)({},e.target.name,e.target.value))},a.state=Object(p.a)({},L),a}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.state,t=e.email,a=e.error,n=""===t;return r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("input",{name:"email",value:this.state.email,onChange:this.onChange,type:"text",placeholder:"Email Address"}),r.a.createElement("button",{disabled:n,type:"submit"},"Reset My Password"),a&&r.a.createElement("p",null,a.message))}}]),t}(n.Component),M=function(){return r.a.createElement("p",null,r.a.createElement(c.b,{to:"/pw-forget"},"Forgot Password?"))},D=function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"PasswordForget"),r.a.createElement(W,null))},W=O(P),V={email:"",password:"",error:null},B=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).onSubmit=function(e){var t=a.state,n=t.email,r=t.password;a.props.firebase.doSignInWithEmailAndPassword(n,r).then(function(){a.setState(Object(p.a)({},V)),a.props.history.push(T)}).catch(function(e){a.setState({error:e})}),e.preventDefault()},a.onChange=function(e){a.setState(Object(h.a)({},e.target.name,e.target.value))},a.state=Object(p.a)({},V),a}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.state,t=e.email,a=e.password,n=e.error,s=""===a||""===t;return r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("label",{htmlFor:"email"},r.a.createElement("b",null,"Email"),r.a.createElement("input",{name:"email",value:t,onChange:this.onChange,type:"text",placeholder:"Email Address"})),r.a.createElement("label",{htmlFor:"password"},r.a.createElement("b",null,"Password"),r.a.createElement("input",{name:"password",value:a,onChange:this.onChange,type:"password",placeholder:"Password"})),r.a.createElement("button",{className:"registerbtn",disabled:s,type:"submit"},"Sign In"),n&&r.a.createElement("p",null,n.message))}}]),t}(n.Component),J=Object(E.a)(u.e,O)(B),z=function(){return r.a.createElement("div",null,r.a.createElement("h1",null,"SignIn"),r.a.createElement(J,null),r.a.createElement(M,null),r.a.createElement(R,null))},H=a(48),q=a(45),K=a.n(q),G=function(e){function t(e){var a;Object(d.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).onPressRetweet=function(){a.props.onReTweet(a.props.tweet,a.props.authUser),a.setState({pressRetweet:!0})},a.onReplyTweet=function(){a.props.onReplyTweet(a.props.tweet.username)},a.onPressFavorite=function(){a.props.onaddFavorite(a.props.tweet,a.props.authUser),a.setState({pressFavorite:!0})},a.onChangeEditText=function(e){a.setState({editText:e.target.value})},a.onSaveEditText=function(){a.props.onEditTweet(a.props.tweet),a.setState({editMode:!1})},a.onToggleEditMode=function(){a.setState(function(e){return{editMode:!e.editMode,editText:a.props.tweet.text}})},a.onFollow=function(){var e="Follow";a.state.followState||(e="Unfollow"),a.setState(function(t){return{followState:!t.followState,followTexte:e}}),a.props.onFollow(a.props.tweet.userId,a.props.authUser)};var n=!0;return 0===a.props.follow.filter(function(e){return e===a.props.tweet.userId}).length&&(n=!1),a.state={pressFavorite:!1,pressRetweet:!1,editMode:!1,name:a.props.name,editText:a.props.tweet.text,followTexte:n?"Unfollow":"Follow",followState:n},a}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props,t=e.tweet,a=e.onRemoveTweet,n=this.state.editMode,s=K()(t.createdAt).fromNow();return r.a.createElement("div",{key:t.uid,className:"root_Tweet_item"},r.a.createElement("div",{className:"user"},r.a.createElement("span",{className:"imgcontainer space"},r.a.createElement("img",{src:t.src,alt:"Avatar",className:"avatar"})),r.a.createElement("span",{className:"username space"},"   ",t.username,"      ",this.state.name),r.a.createElement("span",{className:"date space"},"   ",s),t.editedAt&&r.a.createElement("span",null,"(Edited)"),r.a.createElement("button",{className:"signoutbutton",type:"button",onClick:this.onFollow},this.state.followTexte)),r.a.createElement("h3",null,t.text),r.a.createElement("div",{className:"buttons"},r.a.createElement("div",{className:"icon_reply",onClick:this.onReplyTweet},r.a.createElement("span",{className:"fa fa-reply"},"  Reply")),r.a.createElement("div",{className:"rtGreen space",onClick:this.onPressRetweet},r.a.createElement("span",{className:"fa fa-retweet"}),r.a.createElement("span",{className:"number"},t.retweets,"   Retweet")),r.a.createElement("div",{className:"favYellow space",onClick:this.onPressFavorite},r.a.createElement("span",{className:"fa fa-star"}),r.a.createElement("span",{className:"number"},t.like,"   Like")),!n&&r.a.createElement("div",{className:" space",onClick:function(){return a(t.tid)}},r.a.createElement("span",{className:"fas fa-eraser"}),r.a.createElement("span",{className:"number"},"  Delete"))))}}]),t}(n.Component),X=function(e){var t=e.authUser,a=e.tweets,n=e.onReTweet,s=e.onaddFavorite,o=e.onReplyTweet,i=e.onEditTweet,l=e.onRemoveTweet,c=e.onFollow,u=e.follow,m=e.name;return r.a.createElement("div",{className:"root_listTweet"},a.map(function(e){return r.a.createElement(G,{key:e.tid,authUser:t,tweet:e,name:m,onReTweet:n,onaddFavorite:s,onReplyTweet:o,onEditTweet:i,onRemoveTweet:l,onFollow:c,follow:u})}).reverse())},Y=function(e){function t(e){var a;Object(d.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).onsubmit=function(e){a.props.onCreateTweet(e),a.setState({text:""})},a.onChangeText=function(e){a.setState({text:e.target.value}),a.props.onChangeText(e.target.value)};var n=a.props.userNameToReply?"@".concat(a.props.userNameToReply," "):"";return a.state={text:n,userNameToReply:"toto"},a}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.state,t=e.text,a=e.userNameToReply;return r.a.createElement("form",{onSubmit:this.onsubmit},r.a.createElement("textarea",{className:"tweet_text",name:"text",value:t,onChange:this.onChangeText},a?"@".concat(a," "):""),r.a.createElement("div",{className:"tweet_button"},r.a.createElement("button",{className:"tweet_close",onClick:this.props.onCloseText},"Close"),r.a.createElement("button",{className:"tweet_send",type:"submit"}," Send ")))}}]),t}(n.Component),$=r.a.createContext(null),Q=function(e){var t=function(t){function a(e){var t;return Object(d.a)(this,a),(t=Object(b.a)(this,Object(v.a)(a).call(this,e))).state={authUser:JSON.parse(localStorage.getItem("authUser"))},t}return Object(g.a)(a,t),Object(f.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.listener=this.props.firebase.onAuthUserListener(function(t){localStorage.setItem("authUser",JSON.stringify(t)),e.setState({authUser:t})},function(){localStorage.removeItem("authUser"),e.setState({authUser:null})})}},{key:"componentWillUnmount",value:function(){this.listener()}},{key:"render",value:function(){return r.a.createElement($.Provider,{value:this.state.authUser},r.a.createElement(e,this.props))}}]),a}(r.a.Component);return O(t)},Z=function(e){return function(t){var a=function(a){function n(){return Object(d.a)(this,n),Object(b.a)(this,Object(v.a)(n).apply(this,arguments))}return Object(g.a)(n,a),Object(f.a)(n,[{key:"componentDidMount",value:function(){var t=this;this.listener=this.props.firebase.auth.onAuthStateChanged(function(a){e(a)||t.props.history.push("/signin")})}},{key:"componentWillUnmount",value:function(){this.listener()}},{key:"render",value:function(){var a=this;return r.a.createElement($.Consumer,null,function(n){return e(n)?r.a.createElement(t,a.props):null})}}]),n}(r.a.Component);return Object(E.a)(u.e,O)(a)}},ee=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).onListenForTweets=function(){a.setState({loading:!0}),a.props.firebase.tweets().orderByChild("createdAt").limitToLast(a.state.limit).on("value",function(e){var t=e.val();if(t){var n=Object.keys(t).map(function(e){return Object(p.a)({},t[e],{tid:e})});a.setState({tweets:n,loading:!1})}else a.setState({tweets:null,loading:!1})})},a.onListenForUserDataUpdate=function(){a.props.firebase.user(a.state.authUser.uid).on("value",function(e){a.setState({authUser:e.val()})})},a.onCloseText=function(e){e.preventDefault(),a.setState({openText:!1})},a.renderTweetInput=function(){if(a.state.openText)return r.a.createElement(Y,{authUser:a.state.authUser,onChangeText:a.onChangeText,onCreateTweet:a.onCreateTweet,text:a.state.text,onCloseText:a.onCloseText,userNameToReply:a.state.userNameToReply})},a.onaddFavorite=function(e,t){0===a.state.likes.filter(function(t){return t===e.tid}).length&&(a.props.firebase.tweet(e.tid).child("listLike").push({userId:t.uid,username:t.username}),e.like++,a.props.firebase.tweet(e.tid).child("like").set(e.like),a.props.firebase.user(t.uid).child("listLike").push(e.tid),a.state.likes.push(e.tid))},a.onReTweet=function(e,t){a.state.tweets.push(e),0===a.state.retweets.filter(function(t){return t===e.tid}).length&&(a.props.firebase.tweet(e.tid).child("listreTweets").push({text:a.state.text,userId:t.uid,src:t.src,username:t.username,createdAt:a.props.firebase.serverValue.TIMESTAMP,like:0,retweets:0}),e.retweets++,a.props.firebase.tweet(e.tid).child("retweets").set(e.retweets),a.props.firebase.user(t.uid).child("listRetweet").push(e.tid),a.state.retweets.push(e.tid))},a.onFollow=function(e,t){0===a.state.follow.filter(function(t){return t===e}).length?(a.props.firebase.user(e).child("followers").push(t.uid),a.props.firebase.user(t.uid).child("following").push(e),a.props.firebase.notification(t.notifId).push({uid:t.uid,message:"l'utilisateur vous a follow",vue:!1}),a.state.follow.push(e)):(a.props.firebase.user(e).child("followers").once("value",function(e){e.forEach(function(e){e.val()===t.uid&&e.ref.remove()})}),a.props.firebase.user(t.uid).child("following").once("value",function(t){t.forEach(function(t){t.val()===e&&t.ref.remove()})}),a.state.follow.splice(a.state.follow.indexOf(e),1))},a.onCreateTweet=function(e){var t=a.props.firebase.tweets().push({text:a.state.text,userId:a.state.authUser.uid,username:a.state.authUser.username,createdAt:a.props.firebase.serverValue.TIMESTAMP,src:a.state.authUser.src,like:0,retweets:0,listreTweets:[],listFav:[]}).key;a.props.firebase.user(a.state.authUser.uid).child("myTweet").push(t),a.setState({text:"",openText:!1}),e.preventDefault()},a.onEditTweet=function(e,t){e.tid;var n=Object(H.a)(e,["tid"]);a.props.firebase.tweet(e.tid).set(Object(p.a)({},n,{text:t,editedAt:a.props.firebase.serverValue.TIMESTAMP}))},a.onRemoveTweet=function(e){a.props.firebase.tweet(e).remove()},a.onReplyTweet=function(e){a.setState({openText:!0,userNameToReply:e})},a.onChangeText=function(e){a.setState({text:e})},a.onOpenText=function(e){e.preventDefault(),a.setState({openText:!0})},a.state={text:"",loading:!1,tweets:[],limit:15,openText:!1,userNameToReply:"",isReply:!1,retweets:a.props.authUser.listRetweet?Object.values(a.props.authUser.listRetweet):[],likes:a.props.authUser.listLike?Object.values(a.props.authUser.listLike):[],follow:a.props.authUser.following?Object.values(a.props.authUser.following):[],authUser:a.props.authUser},a}return Object(g.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.onListenForTweets(),this.onListenForUserDataUpdate()}},{key:"componentWillUnmount",value:function(){this.props.firebase.tweets().off()}},{key:"render",value:function(){var e=this.state,t=e.tweets,a=e.loading,n=e.authUser,s=e.follow,o=e.name;return r.a.createElement("div",null,a&&r.a.createElement("div",null,"Loading ..."),r.a.createElement("div",{className:"root_Tweet_item"},r.a.createElement("button",{onClick:this.onOpenText,className:"open_button_tweet"},r.a.createElement("span",{className:"fa fa-lg fa-edit"})," Tweet!"),this.renderTweetInput()),t&&r.a.createElement(X,{authUser:n,tweets:t,name:o,onEditTweet:this.onEditTweet,onRemoveTweet:this.onRemoveTweet,onReTweet:this.onReTweet,onaddFavorite:this.onaddFavorite,onReplyTweet:this.onReplyTweet,onFollow:this.onFollow,follow:s}),!t&&r.a.createElement("div",null,"Aucun tweet trouver ..."))}}]),t}(n.Component),te=Object(E.a)(O,Z(function(e){return!!e}))(ee),ae=function(e){function t(e){return Object(d.a)(this,t),Object(b.a)(this,Object(v.a)(t).call(this,e))}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null)}}]),t}(n.Component),ne=Object(E.a)(O,u.e,Z(function(e){return!!e}))(ae),re=a(93),se=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).onSendPasswordResetEmail=function(){a.props.firebase.doPasswordReset(a.state.user.email)},a.state={user:a.props},a}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=(this.state||[]).user,t=e.listPhoto?Object.values(e.listPhoto):[],a="/usertweet/:id?/"+e.username;return r.a.createElement("div",{className:"card"},r.a.createElement(c.b,{to:N},r.a.createElement("img",{src:e.src,alt:"singe",style:{width:"100%"}})),r.a.createElement("h1",null,r.a.createElement(c.b,{to:a},e.name)),r.a.createElement("p",{className:"title"},r.a.createElement(c.b,{to:a},"@",e.username)),r.a.createElement("p",null,e.bio),r.a.createElement(re.a,{container:!0},t.map(function(e){return r.a.createElement(re.a,{item:!0,xs:4,key:e.url},r.a.createElement("img",{src:e.url,alt:"User_card_P",className:"user_card_P"}))})))}}]),t}(n.Component),oe=O(se),ie=Object(E.a)(Z(function(e){return!!e}))(function(){return r.a.createElement("div",null,r.a.createElement($.Consumer,null,function(e){return r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"leftcolumn"},r.a.createElement(oe,e)),r.a.createElement("div",{className:"rightcolumn"},r.a.createElement(te,{authUser:e})))}))}),le=a(46),ce=a.n(le),ue=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).handleChangeUsername=function(e){return a.setState({username:e.target.value})},a.handleUploadStart=function(){return a.setState({isUploading:!0,progress:0})},a.handleProgress=function(e){return a.setState({progress:e})},a.handleUploadError=function(e){a.setState({isUploading:!1})},a.handleUploadSuccess=function(e){a.setState({avatar:e,progress:100,isUploading:!1}),a.props.firebase.image(a.state.user.uid+"/"+e).getDownloadURL().then(function(e){var t=a.state.user;a.props.firebase.user(t.uid).child("listPhoto").push({url:e}),a.props.firebase.user(t.uid).update({src:e}),a.setState({avatarURL:e})})},a.onChange=function(e){a.setState(Object(h.a)({},e.target.name,e.target.value))},a.onSubmit=function(e){var t=a.state,n=t.username,r=t.name,s=t.email,o=t.bio,i=a.state.user;i.username=n,i.name=r,i.email=s,i.bio=o,a.props.firebase.user(a.state.user.uid).set(Object(p.a)({},a.state.user)).then(function(){a.setState({user:i})}),e.preventDefault()},a.state={text:"",loading:!1,messages:[],limit:5,user:e.authUser,avatarURL:e.authUser.src,name:e.authUser.name,username:e.authUser.username,email:e.authUser.email,bio:e.authUser.bio},a}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.state.user;return r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("div",{className:"imgcontainer"},r.a.createElement("img",{src:this.state.avatarURL,alt:"Avatar",className:"avatar_cardVersion"})),r.a.createElement("div",{className:"container"},r.a.createElement("label",{htmlFor:"username"},r.a.createElement("b",null,"UserName"),r.a.createElement("input",{name:"username",value:this.state.username,onChange:this.onChange,type:"text",placeholder:"Full Name"})),r.a.createElement("label",{htmlFor:"name"},r.a.createElement("b",null,"Name"),r.a.createElement("input",{name:"name",value:this.state.name,onChange:this.onChange,type:"text",placeholder:" Name"})),r.a.createElement("label",{htmlFor:"email"},r.a.createElement("b",null,"Email Address"),r.a.createElement("input",{name:"email",value:this.state.email,onChange:this.onChange,type:"text",placeholder:"Email Address"})),r.a.createElement("label",{htmlFor:"bio"},r.a.createElement("b",null,"bio"),r.a.createElement("textarea",{name:"bio",value:this.state.bio,onChange:this.onChange})),r.a.createElement("label",{className:"registerbtn",style:{backgroundColor:"steelblue",color:"white",width:"100%",pointer:"cursor"}},"Select your awesome avatar",r.a.createElement(ce.a,{hidden:!0,accept:"image/*",storageRef:this.props.firebase.image(e.uid),onUploadStart:this.handleUploadStart,onUploadError:this.handleUploadError,onUploadSuccess:this.handleUploadSuccess,onProgress:this.handleProgress})),r.a.createElement("button",{className:"registerbtn",type:"submit"},"Valider")))}}]),t}(n.Component),me=O(ue),he=Z(function(e){return!!e})(function(){return r.a.createElement($.Consumer,null,function(e){return r.a.createElement(me,{authUser:e})})}),pe=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).changeDis=function(){a.props.onChangeChat(a.state.user.uid)},a.state={user:a.props.user,followState:a.props.currentUserId},a}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.state.user;return r.a.createElement("div",{key:e.uid,value:e.username,onClick:this.changeDis,style:{backgroundColor:this.props.currentUserId===e.uid?"lightblue":"lightgreen"},className:"chat_list"},r.a.createElement("div",{className:"chat_people"},r.a.createElement("div",{className:"chat_img"}," ",r.a.createElement("img",{className:"avatar",src:e.src,alt:"sunil"})," "),r.a.createElement("div",{className:"chat_ib"},r.a.createElement("h5",null,e.username," ",r.a.createElement("span",{className:"chat_date"}," ")))))}}]),t}(n.Component),de=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).onChangeText=function(e){a.setState({text:e.target.value}),a.props.onChangeText(e)},a.state={user:e.authUser,text:""},a}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this,t=this.state.text,a=this.props.users;return r.a.createElement("div",{className:"inbox_people"},r.a.createElement("div",{className:"headind_srch"},r.a.createElement("div",{className:"recent_heading"},r.a.createElement("h4",null,"Recent")),r.a.createElement("div",{className:"srch_bar"},r.a.createElement("div",{className:"stylish-input-group"},r.a.createElement("label",null,r.a.createElement("input",{type:"text",className:"search-bar",name:"text",value:t,onChange:this.onChangeText,placeholder:"Search"})),r.a.createElement("span",{className:"input-group-addon"},r.a.createElement("button",{onClick:this.props.onSearch,type:"button"}," ",r.a.createElement("i",{className:"fa fa-search","aria-hidden":"true"})," "))))),r.a.createElement("div",{className:"inbox_chat"},a.map(function(t){return r.a.createElement("div",{key:t.uid},t.uid!==e.state.user.uid?r.a.createElement(pe,{authUser:e.state.user,user:t,onChangeChat:e.props.onChangeChat,currentUserId:e.props.currentUserId}):"")})))}}]),t}(n.Component),fe=function(e){function t(){return Object(d.a)(this,t),Object(b.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props.isSent;return r.a.createElement("div",{className:e?"outgoing_msg":"incoming_msg"},e?"":r.a.createElement("div",{className:"incoming_msg_img"},r.a.createElement("img",{className:"avatar",src:this.props.pictureSrc,alt:"sunil"})),r.a.createElement("div",{className:e?"sent_msg":"received_msg"},r.a.createElement("div",{className:e?"":"received_withd_msg"},r.a.createElement("p",null,this.props.message.text),r.a.createElement("span",{className:"time_date"}," ",this.props.message.createdAt," 10 "))))}}]),t}(n.Component),be=function(e){var t=e.authUser,a=e.currentUser,n=e.messageList,s=e.onChangeMessage,o=e.message,i=e.onSendMessage;return r.a.createElement("div",{className:"mesgs"},r.a.createElement("div",{className:"msg_history"},n.map(function(e){return r.a.createElement(fe,{key:e.mid,message:e,isSent:t.uid===e.sentBy,pictureSrc:a.src})})),r.a.createElement("div",{className:"type_msg"},r.a.createElement("div",{className:"input_msg_write"},r.a.createElement("label",null,r.a.createElement("input",{type:"text",className:"write_msg",placeholder:"Type a message",value:o,onChange:s})),r.a.createElement("button",{onClick:i,className:"msg_send_btn",type:"button"},r.a.createElement("i",{className:"fa fa-paper-plane-o","aria-hidden":"true"})))))},ve=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).onListenForUsers=function(){a.props.firebase.users().limitToLast(a.state.limit).once("value",function(e){var t=e.val();a.convertFirebaseObjectToArray(t)}).then(function(){a.checkIfChatExist();var e=Object.values(a.context.chat).find(function(e){if(a.state.currentUser.uid===e.targetId)return e});a.setState({chatId:e.chatId})}).then(function(){a.onListenForMessage()})},a.checkIfChatExist=function(){if(void 0===a.context.chat||0===Object.values(a.context.chat).filter(function(e){return e.targetId===a.state.currentUser.uid}).length){var e=a.props.firebase.chats().push().key;a.props.firebase.user(a.context.uid).child("chat").push({chatId:e,targetId:a.state.currentUser.uid}),a.props.firebase.user(a.state.currentUser.uid).child("chat").push({chatId:e,targetId:a.context.uid}),a.context.chat={chatid:{chatId:e,targetId:a.state.currentUser.uid}}}},a.onListenForMessage=function(){a.props.firebase.chat(a.state.chatId).limitToLast(a.state.messagelimit).on("value",function(e){if(e.key===a.state.chatId){var t=e.val();if(t){var n=Object.keys(t).map(function(e){return Object(p.a)({},t[e],{mid:e})});a.setState({messageList:n})}else a.setState({messageList:[]})}})},a.onSearch=function(){a.props.firebase.users().orderByChild("username").equalTo(a.state.text).once("value",function(e){var t=e.val();a.convertFirebaseObjectToArray(t)}).then(function(){a.props.firebase.users().off()})},a.convertFirebaseObjectToArray=function(e){if(e){var t=Object.keys(e).map(function(t){return Object(p.a)({},e[t],{uid:t})}),n=a.context.following?Object.values(a.context.following):[];t.forEach(function(e){e.isFollow=!1,0===n.filter(function(t){return t===e.uid}).length&&(e.isFollow=!0)}),t.length>0?a.setState({users:t,currentUser:t[0],currentUserId:t[0].uid}):a.setState({users:t})}else a.setState({users:[],currentUser:{}})},a.onChangeText=function(e){a.setState({text:e.target.value}),""===e.target.value&&a.onListenForUsers()},a.onChangeMessage=function(e){a.setState({message:e.target.value})},a.onSendMessage=function(){a.props.firebase.chat(a.state.chatId).push({text:a.state.message,createdAt:a.props.firebase.serverValue.TIMESTAMP,sentBy:a.context.uid})},a.onChangeChat=function(e){a.props.firebase.chat(a.state.currentUserId).off("value"),a.setState({currentUserId:e}),a.props.firebase.user(e).once("value",function(e){var t=e.val();t?a.setState({currentUser:t,currentUserId:t.uid}):a.setState({currentUser:a.state.usersList[0],currentUserId:a.state.usersList[0].uid})}).then(function(){a.checkIfChatExist();var e=Object.values(a.context.chat).find(function(e){if(a.state.currentUser.uid===e.targetId)return e});a.setState({chatId:e.chatId})}).then(function(){a.onListenForMessage()})},a.state={messageList:[],limit:20,users:[],currentUser:{},message:"",chatId:"",messagelimit:30,oldchatId:""},a}return Object(g.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.onListenForUsers()}},{key:"componentWillUnmount",value:function(){this.props.firebase.users().off()}},{key:"render",value:function(){return r.a.createElement("div",{className:"messaging"},r.a.createElement("div",{className:"inbox_msg"},r.a.createElement(de,{users:this.state.users,onSearch:this.onSearch,authUser:this.context,currentUserId:this.state.currentUserId,onChangeText:this.onChangeText,onChangeChat:this.onChangeChat}),r.a.createElement(be,{messageList:this.state.messageList,authUser:this.context,currentUser:this.state.currentUser,onChangeMessage:this.onChangeMessage,message:this.state.message,onSendMessage:this.onSendMessage})))}}]),t}(n.Component);ve.contextType=$;var ge=Object(E.a)(O,Z(function(e){return!!e}))(ve),Ee=function(){return r.a.createElement(A,null)},we=function(e){function t(){return Object(d.a)(this,t),Object(b.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.props.notification;return r.a.createElement("li",null,e.message,r.a.createElement("span",{className:"close"},"\xd7"))}}]),t}(n.Component),Oe=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).onListenForTweets=function(){a.setState({loading:!0}),a.props.firebase.notification(a.state.authUser.notifId).limitToLast(a.state.limit).on("value",function(e){var t=e.val();if(t){var n=Object.keys(t).map(function(e){return Object(p.a)({},t[e],{nid:e})});a.setState({notifications:n,loading:!1})}else a.setState({notifications:null,loading:!1})})},a.state={authUser:a.props.authUser,notifications:[],limit:20,loading:!0},a.props.firebase.notifications().off(),a}return Object(g.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.onListenForTweets()}},{key:"componentWillUnmount",value:function(){this.props.firebase.notifications().off()}},{key:"render",value:function(){var e=this.state,t=e.notifications,a=e.loading;return r.a.createElement("div",null,a&&r.a.createElement("div",null,"Loading ..."),r.a.createElement("ul",null,t?t.map(function(e){return r.a.createElement(we,{key:e.nid,notification:e})}).reverse():r.a.createElement("div",null,"Vous n'avez aucune notification")))}}]),t}(n.Component),je=Object(E.a)(O,Z(function(e){return!!e}))(Oe),ye=function(){return r.a.createElement("div",null,r.a.createElement($.Consumer,null,function(e){return r.a.createElement(je,{authUser:e})}))},Se=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).onFollow=function(){a.setState({followState:!a.state.followState}),a.props.onFollow(a.state.user,a.state.followState)},a.state={user:a.props.user,followState:a.props.user.isFollow},a}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.state,t=e.user,a=e.followState;return r.a.createElement("div",{className:"user_list_card",style:{backgroundColor:a?"lightgreen":"lightblue"}},r.a.createElement("div",{className:"chat_img"}," ",r.a.createElement("img",{className:"avatar",src:t.src,alt:"sunil"})," "),r.a.createElement("div",{className:"chat_ib"},r.a.createElement("h5",null,"@",t.username,"  ",r.a.createElement("button",{className:"signoutbutton",type:"button",onClick:this.onFollow},a?"Follow":"Unfollow")),r.a.createElement("p",null,t.bio)))}}]),t}(n.Component),Ce=function(e){function t(e){var a;return Object(d.a)(this,t),(a=Object(b.a)(this,Object(v.a)(t).call(this,e))).onListenForUsers=function(){a.props.firebase.users().limitToLast(a.state.limit).on("value",function(e){var t=e.val();a.convertFirebaseObjectToArray(t)})},a.onFollow=function(e,t){var n=a.state.authUser;t?(a.props.firebase.user(e.uid).child("followers").push(n.uid),a.props.firebase.user(n.uid).child("following").push(e.uid),a.props.firebase.notification(e.notifId).push({uid:n.uid,message:"l'utilisateur "+n.username+" vous a follow",vue:!1}),a.state.follow.push(e.uid)):(a.props.firebase.user(e.uid).child("followers").once("value",function(e){e.forEach(function(e){e.val()===n.uid&&e.ref.remove()})}),a.props.firebase.user(n.uid).child("following").once("value",function(t){t.forEach(function(t){t.val()===e.uid&&t.ref.remove()})}),a.state.follow.splice(a.state.follow.indexOf(e.uid),1))},a.convertFirebaseObjectToArray=function(e){if(e){var t=Object.keys(e).map(function(t){return Object(p.a)({},e[t],{uid:t})}),n=a.state.authUser.following?Object.values(a.props.authUser.following):[];t.splice(a.state.authUser,1),t.forEach(function(e){e.isFollow=!1,0===n.filter(function(t){return t===e.uid}).length&&(e.isFollow=!0)}),a.setState({users:t,loading:!1})}else a.setState({users:null,loading:!1})},a.onSearch=function(){a.props.firebase.users().orderByChild("username").equalTo(a.state.text).once("value",function(e){var t=e.val();a.convertFirebaseObjectToArray(t)}).then(function(){a.props.firebase.users().off()})},a.onChangeText=function(e){a.setState({text:e.target.value}),""===e.target.value&&a.onListenForTweets()},a.state={loading:!0,users:[],limit:20,text:"",authUser:a.props.authUser,follow:a.props.authUser.following?Object.values(a.props.authUser.following):[]},a}return Object(g.a)(t,e),Object(f.a)(t,[{key:"componentDidMount",value:function(){this.onListenForUsers()}},{key:"componentWillUnmount",value:function(){this.props.firebase.users().off()}},{key:"render",value:function(){var e=this,t=this.state,a=t.users,n=t.text;return r.a.createElement("div",{className:"inbox_user_list"},r.a.createElement("div",{className:"headind_srch"},r.a.createElement("div",{className:"recent_heading"},r.a.createElement("h4",null,"Recent")),r.a.createElement("div",{className:"srch_bar"},r.a.createElement("div",{className:"stylish-input-group"},r.a.createElement("input",{type:"text",className:"search-bar",name:"text",value:n,onChange:this.onChangeText,placeholder:"Search"}),r.a.createElement("span",{className:"input-group-addon"},r.a.createElement("button",{onClick:this.onSearch,type:"button"}," ",r.a.createElement("i",{className:"fa fa-search","aria-hidden":"true"})," "))))),r.a.createElement("div",null,a.map(function(t){return r.a.createElement("div",{key:t.uid},t.uid!==e.state.authUser.uid?r.a.createElement(Se,{user:t,onFollow:e.onFollow}):"")})))}}]),t}(n.Component),Ue=Object(E.a)(O,u.e)(Ce),Te=function(e){function t(){return Object(d.a)(this,t),Object(b.a)(this,Object(v.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(f.a)(t,[{key:"render",value:function(){var e=this.context;return r.a.createElement("div",null,r.a.createElement(Ue,{authUser:e}))}}]),t}(n.Component);Te.contextType=$;var Ne=O(Te),xe=O(function(e){var t=e.firebase;return r.a.createElement("button",{className:"signoutbutton",type:"button",onClick:t.doSignOut},r.a.createElement("span",{className:"fa fa-sign-out"})," Sign Out")}),ke=function(){return r.a.createElement("div",{className:"navbar"},r.a.createElement(c.b,{to:T},"Home"),r.a.createElement(c.b,{to:N},"Account"),r.a.createElement(c.b,{to:"/messagerie"},"messagerie"),r.a.createElement(c.b,{to:"/notification"},"Notification"),r.a.createElement(c.b,{to:"/listofuser"},"Listes des utilisateurs"),r.a.createElement(c.b,{className:"right",to:"#"},r.a.createElement(xe,null)))},Fe=function(){return r.a.createElement("div",{className:"navbar"},r.a.createElement(c.b,{className:"right",to:"/signin"},"Sign In"),r.a.createElement(c.b,{className:"right",to:"/signup"},"Sign Up"))},Ie=function(){return r.a.createElement($.Consumer,null,function(e){return e?r.a.createElement(ke,null):r.a.createElement(Fe,null)})},Re=Q(function(){return r.a.createElement(c.a,null,r.a.createElement("div",null,r.a.createElement(m,null),r.a.createElement(Ie,null),r.a.createElement("hr",null),r.a.createElement("div",{className:"container"},r.a.createElement(u.a,{exact:!0,path:"/",component:Ee}),r.a.createElement(u.a,{path:T,component:ie}),r.a.createElement(u.a,{path:"/signup",component:A}),r.a.createElement(u.a,{path:"/signin",component:z}),r.a.createElement(u.a,{path:"/messagerie",component:ge}),r.a.createElement(u.a,{path:"/pw-forget",component:D}),r.a.createElement(u.a,{path:N,component:he}),r.a.createElement(u.a,{path:"/notification",component:ye}),r.a.createElement(u.a,{path:"/listofuser",component:Ne}),r.a.createElement(u.a,{path:"/usertweet/:id?",component:ne}))))}),_e=a(47),Ae=a.n(_e);o.a.render(r.a.createElement(Ae.a,null,r.a.createElement(j.Provider,{value:new U},r.a.createElement(Re,null))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("","/service-worker.js");i?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):l(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):l(t,e)})}}()}},[[50,1,2]]]);
//# sourceMappingURL=main.470c4347.chunk.js.map